// contexts/LanguageContext.tsx
import React, { createContext, useContext, useEffect, useMemo, useState } from "react";

type LangKey = "en" | "si" | "ar" | "ta" | "hi" | "ur";
type LangOption = { key: LangKey; name: string; rtl?: boolean };
type Dict = Record<string, string>;
type Dictionaries = Record<LangKey, Dict>;

/** ðŸ”¹ All strings live here (no external JSON). */
const dictionaries: Dictionaries = {
  en: {
    loading: "Loadingâ€¦",
    language: "Language",
    welcome: "Welcome",
    subtitle: "your intilegent shopping companion",
    search: "Search",
    scanImage: "Scan Image",
    voiceOrder: "Voice Order",
    scanBarcodeQR: "Scan Barcode / QR",
    "scan BarcodeQR": "Scan Barcode / QR",
    "market": "Market",
    assistant: "AI Assistant",
    quickAccess: "Quick Access",
    wishlist: "Wishlist",
    help: "Help",
    settings: "Settings",
    about: "About",
    cart: "Cart",
    marketPlace: "Market Place",
    comingSoonTitle: "Coming soon",
    comingSoon: "This page will be added next.",
    permission: "Permission",
    cameraPermissionRequired: "Camera permission is required",
    smartImageScanner: "Smart Image Scanner",
    imageSearch: "Image Search",
    sampleResult: "This is a sample result.",
    noImageSelected: "No image selected",
    takePhoto: "Take photo",
    chooseFromGallery: "Choose from gallery",
    findSimilarItems: "Find similar items",
    tips: "Tips",
    tipClearFront: "Keep the item clearly in front",
    tipGoodLight: "Use good lighting",
    tipAvoidBusyBg: "Avoid busy backgrounds",
    searchProducts: "Search Products",
    searchPlaceholder: "Search...",
    recentSearches: "Recent Searches",
    noResults: "No results found for",
    voiceSearch: "Voice Search",
    offers: "Offers",
  },
  si: {
    loading: "à¶´à·–à¶»à¶«à¶º à·€à·™à¶¸à·’à¶±à·Šâ€¦",
    language: "à¶·à·à·‚à·à·€",
    welcome: "à¶†à¶ºà·”à¶¶à·à·€à¶±à·Š",
   subtitle: "à¶”à¶¶à¶œà·š à¶¶à·”à¶¯à·Šà¶°à·’à¶¸à¶­à·Š à·€à·™à·…à¶³  à·ƒà·„à¶šà¶»à·” ",
    search: "à·ƒà·œà¶ºà¶±à·Šà¶±",
    scanImage: "à¶´à·’à¶‚à¶­à·–à¶» à·ƒà·Šà¶šà·‘à¶±à·Š",
    voiceOrder: "à·„à¶¬à·’à¶±à·Š à¶‡à¶«à·€à·”à¶¸",
    scanBarcodeQR: "à¶¶à·à¶»à·Šà¶šà·à¶©à·Š / QR",
    "scan BarcodeQR": "à¶¶à·à¶»à·Šà¶šà·à¶©à·Š / QR",
    "market": "à·€à·™à·…à¶³à¶´à·œà·…", 
    assistant: "AI à¶†à¶°à·à¶»à¶š",
    quickAccess: "à¶šà·Šà·€à·’à¶šà·Š à¶´à·Šâ€à¶»à·€à·šà·",
    wishlist: "Wish List",
    help: "à¶‹à¶¯à·€à·Š",
    settings: "à·ƒà·à¶šà·ƒà·”à¶¸à·Š",
    about: "à¶…à¶´ à¶œà·à¶±",
    cart: "à¶šà¶»à¶­à·Šà¶­à¶º",
    marketPlace: "à·€à·™à·…à¶³à¶´à·œà·…",
    comingSoonTitle: "à¶‰à¶šà·Šà¶¸à¶±à·’à¶±à·Š",
    comingSoon: "à¶¸à·š à¶´à·’à¶§à·”à·€ à¶Šà·…à¶Ÿà¶§ à¶‘à¶šà·Š à¶šà¶»à¶¸à·”.",
    permission: "à¶…à·€à·ƒà¶»à¶º",
    cameraPermissionRequired: "à¶šà·à¶¸à¶»à· à¶…à·€à·ƒà¶»à¶º à¶…à·€à·à·Šâ€à¶ºà¶ºà·’",
    smartImageScanner: "Smart Image Scanner",
    imageSearch: "à¶´à·’à¶‚à¶­à·–à¶» à·ƒà·™à·€à·”à¶¸",
    sampleResult: "à¶‹à¶¯à·à·„à¶»à¶« à¶´à·Šâ€à¶»à¶­à·’à¶µà¶½à¶ºà¶šà·’.",
    noImageSelected: "à¶´à·’à¶‚à¶­à·–à¶»à¶ºà¶šà·Š à¶­à·à¶»à·à¶œà·™à¶± à¶±à·à·„à·",
    takePhoto: "à¶¡à·à¶ºà·à¶»à·–à¶´à¶º à¶œà¶±à·Šà¶±",
    chooseFromGallery: "à¶œà·à¶½à¶»à·’à¶ºà·™à¶±à·Š à¶­à·à¶»à¶±à·Šà¶±",
    findSimilarItems: "à·ƒà¶¸à·à¶± à¶·à·à¶«à·Šà¶© à·ƒà·œà¶ºà¶±à·Šà¶±",
    tips: "à¶‰à¶Ÿà·’",
    tipClearFront: "à¶·à·à¶«à·Šà¶©à¶º à¶´à·à·„à·à¶¯à·’à¶½à·’à·€ à¶‰à¶¯à·’à¶»à·’à¶ºà·™à¶±à·Š à¶­à¶¶à¶±à·Šà¶±",
    tipGoodLight: "à·„à·œà¶³ à¶†à¶½à·à¶šà¶º à¶·à·à·€à·’à¶­à· à¶šà¶»à¶±à·Šà¶±",
    tipAvoidBusyBg: "à·€à·à¶©à·’ à¶´à·ƒà·”à¶¶à·’à¶¸à·Š à·€à¶½à·’à¶±à·Š à·€à·à¶½à¶šà·™à¶±à·Šà¶±",
    searchProducts: "à¶·à·à¶«à·Šà¶© à·ƒà·œà¶ºà¶±à·Šà¶±",
    searchPlaceholder: "à·ƒà·œà¶ºà¶±à·Šà¶±...",
    recentSearches: "à¶¸à·‘à¶­ à·ƒà·™à·€à·“à¶¸à·Š",
    noResults: "à¶´à·Šâ€à¶»à¶­à·’à¶µà¶½à¶ºà¶šà·Š à¶±à·à·„à·",
    voiceSearch: "à·„à¶¬ à·ƒà·™à·€à·”à¶¸",
    offers: "à¶‡à·ƒà·à¶¯à·”",
  },
  ar: {
    loading: "â€¦Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„",
    language: "Ø§Ù„Ù„ØºØ©",
    welcome: "Ù…Ø±Ø­Ø¨Ù‹Ø§",
    subtitle: "Ø±ÙÙŠÙ‚ Ø§Ù„ØªØ³ÙˆÙ‘Ù‚ Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ",
    search: "Ø¨Ø­Ø«",
    scanImage: "Ù…Ø³Ø­ ØµÙˆØ±Ø©",
    voiceOrder: "Ø·Ù„Ø¨ ØµÙˆØªÙŠ",
    scanBarcodeQR: "Ù…Ø³Ø­ Ø¨Ø§Ø±ÙƒÙˆØ¯ / QR",
    "scan BarcodeQR": "Ù…Ø³Ø­ Ø¨Ø§Ø±ÙƒÙˆØ¯ / QR",
    "market": "Ø³ÙˆÙ‚", 
    assistant: "Ù…Ø³Ø§Ø¹Ø¯ Ø°ÙƒÙŠ",
    quickAccess: "ÙˆØµÙˆÙ„ Ø³Ø±ÙŠØ¹",
    wishlist: "Ø§Ù„Ù…ÙØ¶Ù„Ø©",
    help: "Ù…Ø³Ø§Ø¹Ø¯Ø©",
    settings: "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",
    about: "Ø­ÙˆÙ„",
    cart: "Ø³Ù„Ø©",
    marketPlace: "Ø§Ù„Ø³ÙˆÙ‚",
    comingSoonTitle: "Ù‚Ø±ÙŠØ¨Ù‹Ø§",
    comingSoon: "Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ù„Ø§Ø­Ù‚Ù‹Ø§.",
    permission: "Ø¥Ø°Ù†",
    cameraPermissionRequired: "ÙŠÙ„Ø²Ù… Ø¥Ø°Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§",
    smartImageScanner: "Ù…Ø§Ø³Ø­ Ø§Ù„ØµÙˆØ± Ø§Ù„Ø°ÙƒÙŠ",
    imageSearch: "Ø¨Ø­Ø« Ø¨Ø§Ù„ØµÙˆØ±",
    sampleResult: "Ù†ØªÙŠØ¬Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©.",
    noImageSelected: "Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±Ø© Ù…Ø­Ø¯Ø¯Ø©",
    takePhoto: "Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø©",
    chooseFromGallery: "Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ø§Ù„Ù…Ø¹Ø±Ø¶",
    findSimilarItems: "Ø§Ø¹Ø«Ø± Ø¹Ù„Ù‰ Ø¹Ù†Ø§ØµØ± Ù…Ø´Ø§Ø¨Ù‡Ø©",
    tips: "Ù†ØµØ§Ø¦Ø­",
    tipClearFront: "Ø¶Ø¹ Ø§Ù„Ø¹Ù†ØµØ± Ø¨ÙˆØ¶ÙˆØ­ Ø£Ù…Ø§Ù… Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§",
    tipGoodLight: "Ø§Ø³ØªØ®Ø¯Ù… Ø¥Ø¶Ø§Ø¡Ø© Ø¬ÙŠØ¯Ø©",
    tipAvoidBusyBg: "ØªØ¬Ù†Ù‘Ø¨ Ø§Ù„Ø®Ù„ÙÙŠØ§Øª Ø§Ù„Ù…Ø²Ø¯Ø­Ù…Ø©",
    searchProducts: "Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",
    searchPlaceholder: "Ø§Ø¨Ø­Ø«...",
    recentSearches: "Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø£Ø®ÙŠØ±Ø©",
    noResults: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„Ù€",
    voiceSearch: "Ø¨Ø­Ø« ØµÙˆØªÙŠ",
    offers: "Ø¹Ø±ÙˆØ¶",
  },
  ta: {
    loading: "à®à®±à¯à®±à¯à®•à®¿à®±à®¤à¯â€¦",
    language: "à®®à¯Šà®´à®¿",
    welcome: "à®µà®£à®•à¯à®•à®®à¯",
    subtitle: "à®‰à®™à¯à®•à®³à¯ à®ªà¯à®¤à¯à®¤à®¿à®šà®¾à®²à®¿ à®·à®¾à®ªà¯à®ªà®¿à®™à¯ à®¤à¯à®£à¯ˆ",
    search: "à®¤à¯‡à®Ÿà®²à¯",
    scanImage: "à®ªà®Ÿ à®¸à¯à®•à¯‡à®©à¯",
    voiceOrder: "à®•à¯à®°à®²à¯ à®†à®°à¯à®Ÿà®°à¯",
    scanBarcodeQR: "à®ªà®¾à®°à¯à®•à¯‹à®Ÿà¯ / QR",
    "scan BarcodeQR": "à®ªà®¾à®°à¯à®•à¯‹à®Ÿà¯ / QR",
    assistant: "à®‰à®¤à®µà®¿à®¯à®¾à®³à®°à¯",
    "market": "à®®à®¾à®°à¯à®•à¯à®•à¯†à®Ÿà¯",
    quickAccess: "à®µà®¿à®°à¯ˆà®µà¯ à®…à®£à¯à®•à®²à¯",
    wishlist: "à®µà®¿à®°à¯à®ªà¯à®ªà®ªà¯ à®ªà®Ÿà¯à®Ÿà®¿à®¯à®²à¯",
    help: "à®‰à®¤à®µà®¿",
    settings: "à®…à®®à¯ˆà®ªà¯à®ªà¯à®•à®³à¯",
    about: "à®ªà®±à¯à®±à®¿",
    cart: "à®µà®£à¯à®Ÿà®¿",
    marketPlace: "à®®à®¾à®°à¯à®•à¯à®•à¯†à®Ÿà¯",
    comingSoonTitle: "à®µà®¿à®°à¯ˆà®µà®¿à®²à¯",
    comingSoon: "à®‡à®¨à¯à®¤à®ªà¯ à®ªà®•à¯à®•à®®à¯ à®ªà®¿à®©à¯à®©à®°à¯ à®šà¯‡à®°à¯à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®®à¯.",
    permission: "à®…à®©à¯à®®à®¤à®¿",
    cameraPermissionRequired: "à®•à¯‡à®®à®°à®¾ à®…à®©à¯à®®à®¤à®¿ à®¤à¯‡à®µà¯ˆ",
    smartImageScanner: "à®¸à¯à®®à®¾à®°à¯à®Ÿà¯ à®‡à®®à¯‡à®œà¯ à®¸à¯à®•à¯‡à®©à®°à¯",
    imageSearch: "à®ªà®Ÿà®¤à¯ à®¤à¯‡à®Ÿà®²à¯",
    sampleResult: "à®®à®¾à®¤à®¿à®°à®¿ à®®à¯à®Ÿà®¿à®µà¯.",
    noImageSelected: "à®ªà®Ÿà®®à¯ à®¤à¯‡à®°à¯à®¨à¯à®¤à¯†à®Ÿà¯à®•à¯à®•à®ªà¯à®ªà®Ÿà®µà®¿à®²à¯à®²à¯ˆ",
    takePhoto: "à®ªà¯à®•à¯ˆà®ªà¯à®ªà®Ÿà®®à¯ à®Žà®Ÿà¯",
    chooseFromGallery: "à®•à¯‡à®²à®°à®¿à®¯à®¿à®²à¯ à®‡à®°à¯à®¨à¯à®¤à¯ à®¤à¯‡à®°à¯à®µà¯ à®šà¯†à®¯à¯",
    findSimilarItems: "à®’à®¤à¯à®¤ à®ªà¯Šà®°à¯à®Ÿà¯à®•à®³à¯ˆ à®•à®£à¯à®Ÿà¯à®ªà®¿à®Ÿà®¿",
    tips: "à®‰à®¤à®µà®¿à®•à¯à®•à¯à®±à®¿à®ªà¯à®ªà¯à®•à®³à¯",
    tipClearFront: "à®ªà¯Šà®°à¯à®³à¯ˆ à®¤à¯†à®³à®¿à®µà®¾à®• à®®à¯à®©à¯à®ªà¯à®±à®®à¯ à®µà¯ˆà®¯à¯à®™à¯à®•à®³à¯",
    tipGoodLight: "à®¨à®²à¯à®² à®’à®³à®¿ à®ªà®¯à®©à¯à®ªà®Ÿà¯à®¤à¯à®¤à¯à®™à¯à®•à®³à¯",
    tipAvoidBusyBg: "à®…à®²à®Ÿà¯à®Ÿà®²à®¾à®© à®ªà®¿à®©à¯à®©à®£à®¿à®•à®³à¯ˆ à®¤à®µà®¿à®°à¯à®•à¯à®•à®µà¯à®®à¯",
    searchProducts: "à®ªà¯Šà®°à¯à®Ÿà¯à®•à®³à¯ˆà®¤à¯ à®¤à¯‡à®Ÿà¯à®™à¯à®•à®³à¯",
    searchPlaceholder: "à®¤à¯‡à®Ÿà¯à®™à¯à®•à®³à¯...",
    recentSearches: "à®šà®®à¯€à®ªà®¤à¯à®¤à®¿à®¯ à®¤à¯‡à®Ÿà®²à¯à®•à®³à¯",
    noResults: "à®®à¯à®Ÿà®¿à®µà¯à®•à®³à¯ à®‡à®²à¯à®²à¯ˆ",
    voiceSearch: "à®•à¯à®°à®²à¯ à®¤à¯‡à®Ÿà®²à¯",
    offers: "à®šà®²à¯à®•à¯ˆà®•à®³à¯",
  },
  hi: {
    loading: "à¤²à¥‹à¤¡ à¤¹à¥‹ à¤°à¤¹à¤¾ à¤¹à¥ˆâ€¦",
    language: "à¤­à¤¾à¤·à¤¾",
    welcome: "à¤¨à¤®à¤¸à¥à¤¤à¥‡",
    subtitle: "à¤†à¤ªà¤•à¤¾ à¤¸à¥à¤®à¤¾à¤°à¥à¤Ÿ à¤¶à¥‰à¤ªà¤¿à¤‚à¤— à¤¸à¤¾à¤¥à¥€",
    search: "à¤–à¥‹à¤œà¥‡à¤‚",
    scanImage: "à¤›à¤µà¤¿ à¤¸à¥à¤•à¥ˆà¤¨",
    voiceOrder: "à¤µà¥‰à¤‡à¤¸ à¤‘à¤°à¥à¤¡à¤°",
    scanBarcodeQR: "à¤¬à¤¾à¤°à¤•à¥‹à¤¡ / QR",
    "scan BarcodeQR": "à¤¬à¤¾à¤°à¤•à¥‹à¤¡ / QR",
    assistant: "à¤à¤†à¤ˆ à¤¸à¤¹à¤¾à¤¯à¤•",
    "market": "à¤®à¤¾à¤°à¥à¤•à¥‡à¤Ÿ",
    quickAccess: "à¤¤à¥à¤µà¤°à¤¿à¤¤ à¤ªà¤¹à¥à¤à¤š",
    wishlist: "à¤‡à¤šà¥à¤›à¤¾ à¤¸à¥‚à¤šà¥€",
    help: "à¤¸à¤¹à¤¾à¤¯à¤¤à¤¾",
    settings: "à¤¸à¥‡à¤Ÿà¤¿à¤‚à¤—à¥à¤¸",
    about: "à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€",
    cart: "à¤•à¤¾à¤°à¥à¤Ÿ",
    marketPlace: "à¤®à¤¾à¤°à¥à¤•à¥‡à¤Ÿ",
    comingSoonTitle: "à¤œà¤²à¥à¤¦ à¤† à¤°à¤¹à¤¾ à¤¹à¥ˆ",
    comingSoon: "à¤¯à¤¹ à¤ªà¥‡à¤œ à¤¬à¤¾à¤¦ à¤®à¥‡à¤‚ à¤œà¥‹à¤¡à¤¼à¤¾ à¤œà¤¾à¤à¤—à¤¾à¥¤",
    permission: "à¤…à¤¨à¥à¤®à¤¤à¤¿",
    cameraPermissionRequired: "à¤•à¥ˆà¤®à¤°à¤¾ à¤…à¤¨à¥à¤®à¤¤à¤¿ à¤†à¤µà¤¶à¥à¤¯à¤• à¤¹à¥ˆ",
    smartImageScanner: "à¤¸à¥à¤®à¤¾à¤°à¥à¤Ÿ à¤‡à¤®à¥‡à¤œ à¤¸à¥à¤•à¥ˆà¤¨à¤°",
    imageSearch: "à¤šà¤¿à¤¤à¥à¤° à¤–à¥‹à¤œ",
    sampleResult: "à¤¨à¤®à¥‚à¤¨à¤¾ à¤ªà¤°à¤¿à¤£à¤¾à¤®à¥¤",
    noImageSelected: "à¤•à¥‹à¤ˆ à¤¤à¤¸à¥à¤µà¥€à¤° à¤šà¥à¤¨à¥€ à¤¨à¤¹à¥€à¤‚ à¤—à¤ˆ",
    takePhoto: "à¤«à¥‹à¤Ÿà¥‹ à¤²à¥‡à¤‚",
    chooseFromGallery: "à¤—à¥ˆà¤²à¤°à¥€ à¤¸à¥‡ à¤šà¥à¤¨à¥‡à¤‚",
    findSimilarItems: "à¤¸à¤®à¤¾à¤¨ à¤†à¤‡à¤Ÿà¤® à¤¢à¥‚à¤‚à¤¢à¥‡à¤‚",
    tips: "à¤Ÿà¤¿à¤ªà¥à¤¸",
    tipClearFront: "à¤µà¤¸à¥à¤¤à¥ à¤•à¥‹ à¤¸à¥à¤ªà¤·à¥à¤Ÿ à¤°à¥‚à¤ª à¤¸à¥‡ à¤¸à¤¾à¤®à¤¨à¥‡ à¤°à¤–à¥‡à¤‚",
    tipGoodLight: "à¤…à¤šà¥à¤›à¥€ à¤°à¥‹à¤¶à¤¨à¥€ à¤•à¤¾ à¤‰à¤ªà¤¯à¥‹à¤— à¤•à¤°à¥‡à¤‚",
    tipAvoidBusyBg: "à¤µà¥à¤¯à¤¸à¥à¤¤ à¤ªà¥ƒà¤·à¥à¤ à¤­à¥‚à¤®à¤¿ à¤¸à¥‡ à¤¬à¤šà¥‡à¤‚",
    searchProducts: "à¤‰à¤¤à¥à¤ªà¤¾à¤¦ à¤–à¥‹à¤œà¥‡à¤‚",
    searchPlaceholder: "à¤–à¥‹à¤œà¥‡à¤‚...",
    recentSearches: "à¤¹à¤¾à¤² à¤•à¥€ à¤–à¥‹à¤œà¥‡à¤‚",
    noResults: "à¤•à¥‹à¤ˆ à¤ªà¤°à¤¿à¤£à¤¾à¤® à¤¨à¤¹à¥€à¤‚",
    voiceSearch: "à¤µà¥‰à¤‡à¤¸ à¤–à¥‹à¤œ",
    offers: "à¤‘à¤«à¤¼à¤°",
  },
  ur: {
    loading: "Ù„ÙˆÚˆ ÛÙˆ Ø±ÛØ§ ÛÛ’â€¦",
    language: "Ø²Ø¨Ø§Ù†",
    welcome: "Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯",
   
    search: "ØªÙ„Ø§Ø´",
    scanImage: "ØªØµÙˆÛŒØ± Ø§Ø³Ú©ÛŒÙ†",
    voiceOrder: "ÙˆØ§Ø¦Ø³ Ø¢Ø±ÚˆØ±",
    scanBarcodeQR: "Ø¨Ø§Ø±Ú©ÙˆÚˆ / QR",
    "scan BarcodeQR": "Ø¨Ø§Ø±Ú©ÙˆÚˆ / QR",
    assistant: "Ø§Ø³Ø³Ù¹Ù†Ù¹",
    "market": "Ù…Ø§Ø±Ú©ÛŒÙ¹",
     quickAccess: "ÙÙˆØ±ÛŒ Ø±Ø³Ø§Ø¦ÛŒ",
    wishlist: "Ù¾Ø³Ù†Ø¯ÛŒØ¯Û",
    help: "Ù…Ø¯Ø¯",
    settings: "Ø³ÛŒÙ¹Ù†Ú¯Ø²",
    about: "Ù…ØªØ¹Ù„Ù‚",
    cart: "Ú©Ø§Ø±Ù¹",
    marketPlace: "Ù…Ø§Ø±Ú©ÛŒÙ¹ Ù¾Ù„ÛŒØ³",
    comingSoonTitle: "Ø¬Ù„Ø¯ Ø¢Ø±ÛØ§ ÛÛ’",
    comingSoon: "ÛŒÛ ØµÙØ­Û Ø¨Ø¹Ø¯ Ù…ÛŒÚº Ø´Ø§Ù…Ù„ Ú©ÛŒØ§ Ø¬Ø§Ø¦Û’ Ú¯Ø§Û”",
    permission: "Ø§Ø¬Ø§Ø²Øª",
    cameraPermissionRequired: "Ú©ÛŒÙ…Ø±Û Ø§Ø¬Ø§Ø²Øª Ø¯Ø±Ú©Ø§Ø± ÛÛ’",
    smartImageScanner: "Ø³Ù…Ø§Ø±Ù¹ Ø§Ù…ÛŒØ¬ Ø§Ø³Ú©ÛŒÙ†Ø±",
    imageSearch: "ØªØµÙˆÛŒØ±ÛŒ ØªÙ„Ø§Ø´",
    sampleResult: "Ù†Ù…ÙˆÙ†Û Ù†ØªÛŒØ¬Û.",
    noImageSelected: "Ú©ÙˆØ¦ÛŒ ØªØµÙˆÛŒØ± Ù…Ù†ØªØ®Ø¨ Ù†ÛÛŒÚº",
    takePhoto: "ØªØµÙˆÛŒØ± Ú©Ú¾ÛŒÙ†Ú†ÛŒÚº",
    chooseFromGallery: "Ú¯ÛŒÙ„Ø±ÛŒ Ø³Û’ Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº",
    findSimilarItems: "Ù…Ø´Ø§Ø¨Û Ø§Ø´ÛŒØ§Ø¡ ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº",
    tips: "Ù…Ø´ÙˆØ±Û’",
    tipClearFront: "Ø´Û’ Ú©Ùˆ ÙˆØ§Ø¶Ø­ Ø·ÙˆØ± Ù¾Ø± Ø³Ø§Ù…Ù†Û’ Ø±Ú©Ú¾ÛŒÚº",
    tipGoodLight: "Ø§Ú†Ú¾ÛŒ Ø±ÙˆØ´Ù†ÛŒ Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ø±ÛŒÚº",
    tipAvoidBusyBg: "Ù…ØµØ±ÙˆÙ Ù¾Ø³ Ù…Ù†Ø¸Ø± Ø³Û’ Ú¯Ø±ÛŒØ² Ú©Ø±ÛŒÚº",
    searchProducts: "Ù…ØµÙ†ÙˆØ¹Ø§Øª ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº",
    searchPlaceholder: "ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº...",
    recentSearches: "Ø­Ø§Ù„ÛŒÛ ØªÙ„Ø§Ø´ÛŒÚº",
    noResults: "Ú©ÙˆØ¦ÛŒ Ù†ØªÛŒØ¬Û Ù†ÛÛŒÚº",
    voiceSearch: "ÙˆØ§Ø¦Ø³ ØªÙ„Ø§Ø´",
    offers: "Ø¢ÙØ±Ø²",
  },
};

const languageOptions: LangOption[] = [
  { key: "en", name: "English" },
  { key: "si", name: "à·ƒà·’à¶‚à·„à¶½" },
  { key: "ar", name: "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©", rtl: true },
  { key: "ta", name: "à®¤à®®à®¿à®´à¯" },
  { key: "hi", name: "à¤¹à¤¿à¤¨à¥à¤¦à¥€" },
  { key: "ur", name: "Ø§Ø±Ø¯Ùˆ", rtl: true },
];

type Ctx = {
  t: (k: string) => string;
  lang: LangKey;
  setLang: (l: LangKey) => void;
  languages: LangOption[];
  isRTL: boolean;
  isReady: boolean;
};

const LanguageCtx = createContext<Ctx | null>(null);

export function LanguageProvider({ children }: { children: React.ReactNode }) {
  const [lang, setLang] = useState<LangKey>("en");
  const [isReady, setReady] = useState(false);

  useEffect(() => setReady(true), []);

  const isRTL = useMemo(() => languageOptions.find(o => o.key === lang)?.rtl === true, [lang]);

  /** ðŸ”¸ Lookup with graceful fallbacks (space-insensitive alt key). */
  const t = (k: string) => {
    const dict = dictionaries[lang] || dictionaries.en;
    const en = dictionaries.en;
    const alt = k.replace(/\s+/g, "");
    return dict[k] ?? dict[alt] ?? en[k] ?? en[alt] ?? k;
  };

  const value: Ctx = { t, lang, setLang, languages: languageOptions, isRTL, isReady };
  return <LanguageCtx.Provider value={value}>{children}</LanguageCtx.Provider>;
}

export function useLanguage(): Ctx {
  const ctx = useContext(LanguageCtx);
  if (!ctx) throw new Error("useLanguage must be used within LanguageProvider");
  return ctx;
}
